# モンスター対戦（仮） 要件定義

このページは、ブラウザで遊べる「モンスター対戦（仮）」の要件定義をまとめたものです。
プレイヤーはモンスターを選び、技をセットし、コンピュータと対戦します。
ゲームの訴求点は「駆け引きの面白さ」と「選択の戦略性」にあり、実際にプレイしたユーザーからフィードバックを集め、改良を重ねていくことを目的としています。

---

## 目次

[:contents]

---

## ゲームタイトル

* 本ゲームのタイトルは **「モンスター対戦（仮）」** とする。

---

## 0. 目的

* ブラウザで動作するゲームを試作し、実際にプレイヤーに遊んでもらう。
* ゲームの訴求点や駆け引きの面白さを体験ベースで説明・検証する。
* プレイヤーからフィードバックを集め、ゲームシステムをブラッシュアップする。

---

## 1. 画面構成と要件

### 1.1 開始画面

* **ゲームタイトル表示**：「モンスター対戦（仮）」を画面上部中央に大きく表示。
* **画面名表示**：「開始画面」ヘッダーを画面上部に常時表示。
* **機能**

  * ゲーム導入と遊び方の全体像を説明。
  * 「▶ モンスターを選ぶ」ボタンでモンスター選択画面へ遷移。
* **説明ウインドウ**（下部常時表示、戻るボタン直上）

  * このゲームはモンスターを選び、技をセットしてバトルするブラウザゲームです。
  * ゲームのコンセプトについては *こちらの記事* を参照してください。
  * 要件定義については *こちらの記事* を参照してください。
* **戻るボタン**：不要。

---

### 1.2 モンスター選択画面

* **画面名表示**：「モンスター選択画面」ヘッダーを画面上部に常時表示。
* **機能**

  * 相手はランダムで6体を選出し候補として表示。
  * バトル開始時、相手はその6体の中から3体を密かに選んで出場。
  * プレイヤーは全モンスターから3体を選択。
  * 選択数カウンター (n/3) を表示。
  * 3体選択後に「技を選ぶ」ボタンが有効化し、押すと技選択画面に遷移する。
  * 属性相対表を簡易マトリクス形式（〇/△/×表記、全属性一覧）で表示し、モンスター選択時に参照可能。
  * ガイドメッセージ表示（ボタン式）：プレイヤーが「おすすめを見る」を押すと、コンピュータの選んだ6体の情報を基に有利なモンスターを提示。例：「水属性に対抗できる炎属性を選ぶのがおすすめです」。
* **説明ウインドウ**

  * 相手は6体の候補から3体を選んできます（どの3体かは非公開）。
  * 属性やステータスを見て予測しながら自分の3体を選びましょう。
  * 属性相対表やガイドメッセージを参考にして、相性の良いチームを構築してください。
* **戻るボタン**

  * 下部中央に配置し開始画面に戻る。
  * 戻った場合、選択状態は保持する。

---

### 1.3 技選択画面

* **画面名表示**：「技選択画面」ヘッダーを画面上部に常時表示。
* **入力引き継ぎ**：モンスター選択画面で選んだ3体の情報（内部ID、名称、属性、ステータス：HP/STA/ATK/DEF/MAG/SPD、選択順）を受け取り表示。
* **機能**

  * 画面上部にコンピュータの選出6体を常時表示。
  * プレイヤーはその情報を参照しながら、自分のモンスターの技をセット。
  * 各モンスターは必ず4つ技をセット（4つ未満は遷移不可）。
  * 技は選択済みリストから個別解除可能。解除後は再選択可。
  * 技リストには属性・威力・消費スタミナを明示。
  * 技選択は1体目→2体目→3体目の順に行い、3体目完了後「バトルへ」ボタンで遷移。
  * いずれかのモンスターが未完了なら自動遷移し「未完了メッセージ」を表示。
* **説明ウインドウ**

  * 「ちょうど4つ選んでください。選択済みはタップで解除できます。」
  * 属性一致技は威力が2倍。
  * 同属性ばかりでは不利属性に対応できないため注意。
  * 強い技はST消費が大きいため、バランスよく選びましょう。
* **戻るボタン**

  * 下部中央に配置しモンスター選択画面に戻る。

---

### 1.4 バトル画面

* **画面名表示**：「バトル画面」ヘッダーを画面上部に常時表示。
* **機能**

  * プレイヤーと相手が1体ずつ出場し対戦。
  * HP・STゲージ、ステータスを表示。
  * プレイヤーは以下を選択可能：

    1. 技（セットした4つ）
    2. モンスター交代
    3. 降参（プレイヤー専用、即敗北）
  * **技ボタン情報**

    * 技名、威力、消費スタミナ、属性マーク
    * 相性が良い場合「〇」、不利なら「×」
    * 補正時は威力変化を表示（例：10→20）
  * ST不足技は選択不可。
  * 補助技「ガード」：STを消費し、次の被ダメ1回のみ半減。
  * バトルログに履歴を表示。
  * バトル終了時、勝敗と「感謝とコメント促しメッセージ」を表示。
  * 「リスタート」で開始画面へ戻る。
* **説明ウインドウ**

  * 技や交代を選んで駆け引きを楽しむ。
  * 攻撃時は属性エフェクトで「誰が何属性で攻撃したか」を明示。
  * 終了時に「感謝とコメント促しメッセージ」を表示。
* **戻るボタン**

  * 下部中央に配置し技選択画面に戻る（バトルは破棄）。

---

## 2. データ仕様

### 2.1 モンスター

* パラメータ：HP、スタミナ(ST)、攻撃(ATK)、防御(DEF)、魔力(MAG)、素早さ(SPD)
* 属性：炎、水、風、土、雷、氷、光、闇
* 識別情報：内部IDを付与し、画面間で引き継ぎに利用

### 2.2 技

* 技名、タイプ（物理/魔法/補助）、威力、消費スタミナ、属性
* プレイヤーはプールから4つ選択
* 属性一致技は威力2倍

---

## 3. バトルルール（暫定）

* ターン制コマンドバトル
* プレイヤーとCPUは同時に行動選択
* SPD高い方が先攻。同値はランダム
* ダメージ計算式：

```
dmg = floor(base × STAB × 相性 × 乱数)
base = floor(pow × (10+攻撃) / (10+防御))
STAB = 2.0
相性 = {1.5 / 1.0 / 0.5}
乱数 ∈ [0.85, 1.00]
```

* ST不足技は不可
* ガード：STを消費し次の被ダメ半減
* 属性相性例：炎>氷、水>炎/土、風>土、土>雷、雷>水、氷>風、光↔闇

---

## 4. 攻撃演出要件

* 攻撃時、モンスターカードが光る/拡大
* 属性ごとに飛び道具（火球、稲妻、氷槍）
* ヒット時に専用演出（爆発、水しぶき、氷結）
* 大ダメージ時にシェイク
* 実装方式

  * 簡易：CSSアニメーション
  * 発展：Canvas/SVG/画像

---

## 5. UI共通要件

* 説明ウインドウ：全画面下部に常時表示（戻るボタン直上）
* 戻るボタン：下部中央
* 戻る操作時は選択状態を保持
* スマホ利用を想定し誤タップ防止のUI
* 画面名を上部に常時表示
* 画面間で選択データを引き継ぐ

---

## 6. フィードバック要件

* バトル終了時に以下を表示：

```
プレイしていただきありがとうございました！
ぜひ感想や改善点のコメントをお願いします。
このゲームをより面白くするためのご意見をお待ちしています。
```

* リスタート時に非表示に戻す

---

## 7. 今後の検討事項（バックログ）

* ダメージ計算式の確定
* SPD同値時の処理
* ST不足時の挙動
* 交代ルール詳細
* 状態異常/バフデバフ
* クリティカル・回避
* 相性倍率最終調整
* 複合属性や無属性
* 技設計（効率・制限）
* CPUピック/技選択AI
* 演出強化（Canvas、音）
* UI改善（コマンド配置、相性表示）
* コンテンツ拡張（新モンスター/技/天候）
* 計測と改善導線
* 難易度・バランス調整
* 品質・技術（アクセシビリティ、回帰テスト）
* SEO・広報（ブログ埋め込み、更新履歴自動化）

---

## 8. 変更履歴

* 2025-09-26: 技選択画面に「4つ必須」「解除/再選択」機能を追加
* 2025-09-26: ガイダンス「ちょうど4つ選んでください」を常時表示
* 2025-09-26: CPU行動方針（与ダメ最大技、交代、ガード）を追加
* 2025-09-26: ダメージ計算式を定義（STAB=2.0、乱数0.85–1.00）
* 2025-09-26: バトル画面に技詳細（威力補正・相性マーク）を追加
* 2025-09-26: モンスター選択画面に属性相対表を追加
* 2025-09-26: 「おすすめを見る」ボタンを追加しガイド機能を実装
* 2025-09-26: 各画面に画面名を常時表示する要件を追加
* 2025-09-26: 初版要件定義を作成
